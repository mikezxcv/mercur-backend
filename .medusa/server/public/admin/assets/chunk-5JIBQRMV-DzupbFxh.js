import{u as st}from"./chunk-PFKKVLZX-DbRdS3RV.js";import{bO as R,bP as rt,bQ as be,bR as se,bS as nt,bT as it,r as j,b as z,ao as me,j as s,aH as H,bU as Ue,B as lt,bV as q,aK as J,I as O,aM as Z,bW as le,_ as K,bX as ye,bG as Ke,a0 as X,Y as Q,bY as U,a2 as ze,bZ as ot,aI as ut}from"./index-Bxfpjf1r.js";import{_ as he,a as He,b as qe,e as ct,i as xe,c as dt,d as ft,f as re,g as gt}from"./_isIndex-C-mfepo0.js";import{R as pt,I as vt,a as bt}from"./index-lHq2NlHa.js";var mt=he;function ht(){this.__data__=new mt,this.size=0}var xt=ht;function yt(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a}var _t=yt;function jt(e){return this.__data__.get(e)}var $t=jt;function Tt(e){return this.__data__.has(e)}var wt=Tt,St=he,At=He,Ot=qe,Nt=200;function Ct(e,t){var a=this.__data__;if(a instanceof St){var n=a.__data__;if(!At||n.length<Nt-1)return n.push([e,t]),this.size=++a.size,this;a=this.__data__=new Ot(n)}return a.set(e,t),this.size=a.size,this}var Pt=Ct,Et=he,Dt=xt,It=_t,Mt=$t,Ft=wt,Lt=Pt;function V(e){var t=this.__data__=new Et(e);this.size=t.size}V.prototype.clear=Dt;V.prototype.delete=It;V.prototype.get=Mt;V.prototype.has=Ft;V.prototype.set=Lt;var Rt=V,Vt="__lodash_hash_undefined__";function kt(e){return this.__data__.set(e,Vt),this}var Bt=kt;function Gt(e){return this.__data__.has(e)}var Ut=Gt,Kt=qe,zt=Bt,Ht=Ut;function ee(e){var t=-1,a=e==null?0:e.length;for(this.__data__=new Kt;++t<a;)this.add(e[t])}ee.prototype.add=ee.prototype.push=zt;ee.prototype.has=Ht;var qt=ee;function Jt(e,t){for(var a=-1,n=e==null?0:e.length;++a<n;)if(t(e[a],a,e))return!0;return!1}var Wt=Jt;function Yt(e,t){return e.has(t)}var Xt=Yt,Qt=qt,Zt=Wt,ea=Xt,ta=1,aa=2;function sa(e,t,a,n,i,r){var o=a&ta,u=e.length,f=t.length;if(u!=f&&!(o&&f>u))return!1;var d=r.get(e),c=r.get(t);if(d&&c)return d==t&&c==e;var b=-1,v=!0,m=a&aa?new Qt:void 0;for(r.set(e,t),r.set(t,e);++b<u;){var l=e[b],g=t[b];if(n)var x=o?n(g,l,b,t,e,r):n(l,g,b,e,t,r);if(x!==void 0){if(x)continue;v=!1;break}if(m){if(!Zt(t,function(h,y){if(!ea(m,y)&&(l===h||i(l,h,a,n,r)))return m.push(y)})){v=!1;break}}else if(!(l===g||i(l,g,a,n,r))){v=!1;break}}return r.delete(e),r.delete(t),v}var Je=sa,ra=R,na=ra.Uint8Array,ia=na;function la(e){var t=-1,a=Array(e.size);return e.forEach(function(n,i){a[++t]=[i,n]}),a}var oa=la;function ua(e){var t=-1,a=Array(e.size);return e.forEach(function(n){a[++t]=n}),a}var ca=ua,_e=rt,je=ia,da=ct,fa=Je,ga=oa,pa=ca,va=1,ba=2,ma="[object Boolean]",ha="[object Date]",xa="[object Error]",ya="[object Map]",_a="[object Number]",ja="[object RegExp]",$a="[object Set]",Ta="[object String]",wa="[object Symbol]",Sa="[object ArrayBuffer]",Aa="[object DataView]",$e=_e?_e.prototype:void 0,oe=$e?$e.valueOf:void 0;function Oa(e,t,a,n,i,r,o){switch(a){case Aa:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Sa:return!(e.byteLength!=t.byteLength||!r(new je(e),new je(t)));case ma:case ha:case _a:return da(+e,+t);case xa:return e.name==t.name&&e.message==t.message;case ja:case Ta:return e==t+"";case ya:var u=ga;case $a:var f=n&va;if(u||(u=pa),e.size!=t.size&&!f)return!1;var d=o.get(e);if(d)return d==t;n|=ba,o.set(e,t);var c=fa(u(e),u(t),n,i,r,o);return o.delete(e),c;case wa:if(oe)return oe.call(e)==oe.call(t)}return!1}var Na=Oa;function Ca(e,t){for(var a=-1,n=t.length,i=e.length;++a<n;)e[i+a]=t[a];return e}var Pa=Ca,Ea=Pa,Da=xe;function Ia(e,t,a){var n=t(e);return Da(e)?n:Ea(n,a(e))}var Ma=Ia;function Fa(e,t){for(var a=-1,n=e==null?0:e.length,i=0,r=[];++a<n;){var o=e[a];t(o,a,e)&&(r[i++]=o)}return r}var La=Fa;function Ra(){return[]}var Va=Ra,ka=La,Ba=Va,Ga=Object.prototype,Ua=Ga.propertyIsEnumerable,Te=Object.getOwnPropertySymbols,Ka=Te?function(e){return e==null?[]:(e=Object(e),ka(Te(e),function(t){return Ua.call(e,t)}))}:Ba,za=Ka;function Ha(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}var qa=Ha,Ja=be,Wa=se,Ya="[object Arguments]";function Xa(e){return Wa(e)&&Ja(e)==Ya}var Qa=Xa,we=Qa,Za=se,We=Object.prototype,es=We.hasOwnProperty,ts=We.propertyIsEnumerable,as=we(function(){return arguments}())?we:function(e){return Za(e)&&es.call(e,"callee")&&!ts.call(e,"callee")},ss=as,te={exports:{}};function rs(){return!1}var ns=rs;te.exports;(function(e,t){var a=R,n=ns,i=t&&!t.nodeType&&t,r=i&&!0&&e&&!e.nodeType&&e,o=r&&r.exports===i,u=o?a.Buffer:void 0,f=u?u.isBuffer:void 0,d=f||n;e.exports=d})(te,te.exports);var Ye=te.exports,is=9007199254740991;function ls(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=is}var Xe=ls,os=be,us=Xe,cs=se,ds="[object Arguments]",fs="[object Array]",gs="[object Boolean]",ps="[object Date]",vs="[object Error]",bs="[object Function]",ms="[object Map]",hs="[object Number]",xs="[object Object]",ys="[object RegExp]",_s="[object Set]",js="[object String]",$s="[object WeakMap]",Ts="[object ArrayBuffer]",ws="[object DataView]",Ss="[object Float32Array]",As="[object Float64Array]",Os="[object Int8Array]",Ns="[object Int16Array]",Cs="[object Int32Array]",Ps="[object Uint8Array]",Es="[object Uint8ClampedArray]",Ds="[object Uint16Array]",Is="[object Uint32Array]",$={};$[Ss]=$[As]=$[Os]=$[Ns]=$[Cs]=$[Ps]=$[Es]=$[Ds]=$[Is]=!0;$[ds]=$[fs]=$[Ts]=$[gs]=$[ws]=$[ps]=$[vs]=$[bs]=$[ms]=$[hs]=$[xs]=$[ys]=$[_s]=$[js]=$[$s]=!1;function Ms(e){return cs(e)&&us(e.length)&&!!$[os(e)]}var Fs=Ms;function Ls(e){return function(t){return e(t)}}var Rs=Ls,ae={exports:{}};ae.exports;(function(e,t){var a=nt,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,r=i&&i.exports===n,o=r&&a.process,u=function(){try{var f=i&&i.require&&i.require("util").types;return f||o&&o.binding&&o.binding("util")}catch{}}();e.exports=u})(ae,ae.exports);var Vs=ae.exports,ks=Fs,Bs=Rs,Se=Vs,Ae=Se&&Se.isTypedArray,Gs=Ae?Bs(Ae):ks,Qe=Gs,Us=qa,Ks=ss,zs=xe,Hs=Ye,qs=dt,Js=Qe,Ws=Object.prototype,Ys=Ws.hasOwnProperty;function Xs(e,t){var a=zs(e),n=!a&&Ks(e),i=!a&&!n&&Hs(e),r=!a&&!n&&!i&&Js(e),o=a||n||i||r,u=o?Us(e.length,String):[],f=u.length;for(var d in e)(t||Ys.call(e,d))&&!(o&&(d=="length"||i&&(d=="offset"||d=="parent")||r&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||qs(d,f)))&&u.push(d);return u}var Qs=Xs,Zs=Object.prototype;function er(e){var t=e&&e.constructor,a=typeof t=="function"&&t.prototype||Zs;return e===a}var tr=er;function ar(e,t){return function(a){return e(t(a))}}var sr=ar,rr=sr,nr=rr(Object.keys,Object),ir=nr,lr=tr,or=ir,ur=Object.prototype,cr=ur.hasOwnProperty;function dr(e){if(!lr(e))return or(e);var t=[];for(var a in Object(e))cr.call(e,a)&&a!="constructor"&&t.push(a);return t}var fr=dr,gr=ft,pr=Xe;function vr(e){return e!=null&&pr(e.length)&&!gr(e)}var br=vr,mr=Qs,hr=fr,xr=br;function yr(e){return xr(e)?mr(e):hr(e)}var _r=yr,jr=Ma,$r=za,Tr=_r;function wr(e){return jr(e,Tr,$r)}var Sr=wr,Oe=Sr,Ar=1,Or=Object.prototype,Nr=Or.hasOwnProperty;function Cr(e,t,a,n,i,r){var o=a&Ar,u=Oe(e),f=u.length,d=Oe(t),c=d.length;if(f!=c&&!o)return!1;for(var b=f;b--;){var v=u[b];if(!(o?v in t:Nr.call(t,v)))return!1}var m=r.get(e),l=r.get(t);if(m&&l)return m==t&&l==e;var g=!0;r.set(e,t),r.set(t,e);for(var x=o;++b<f;){v=u[b];var h=e[v],y=t[v];if(n)var w=o?n(y,h,v,t,e,r):n(h,y,v,e,t,r);if(!(w===void 0?h===y||i(h,y,a,n,r):w)){g=!1;break}x||(x=v=="constructor")}if(g&&!x){var S=e.constructor,C=t.constructor;S!=C&&"constructor"in e&&"constructor"in t&&!(typeof S=="function"&&S instanceof S&&typeof C=="function"&&C instanceof C)&&(g=!1)}return r.delete(e),r.delete(t),g}var Pr=Cr,Er=re,Dr=R,Ir=Er(Dr,"DataView"),Mr=Ir,Fr=re,Lr=R,Rr=Fr(Lr,"Promise"),Vr=Rr,kr=re,Br=R,Gr=kr(Br,"Set"),Ur=Gr,Kr=re,zr=R,Hr=Kr(zr,"WeakMap"),qr=Hr,de=Mr,fe=He,ge=Vr,pe=Ur,ve=qr,Ze=be,k=gt,Ne="[object Map]",Jr="[object Object]",Ce="[object Promise]",Pe="[object Set]",Ee="[object WeakMap]",De="[object DataView]",Wr=k(de),Yr=k(fe),Xr=k(ge),Qr=k(pe),Zr=k(ve),I=Ze;(de&&I(new de(new ArrayBuffer(1)))!=De||fe&&I(new fe)!=Ne||ge&&I(ge.resolve())!=Ce||pe&&I(new pe)!=Pe||ve&&I(new ve)!=Ee)&&(I=function(e){var t=Ze(e),a=t==Jr?e.constructor:void 0,n=a?k(a):"";if(n)switch(n){case Wr:return De;case Yr:return Ne;case Xr:return Ce;case Qr:return Pe;case Zr:return Ee}return t});var en=I,ue=Rt,tn=Je,an=Na,sn=Pr,Ie=en,Me=xe,Fe=Ye,rn=Qe,nn=1,Le="[object Arguments]",Re="[object Array]",Y="[object Object]",ln=Object.prototype,Ve=ln.hasOwnProperty;function on(e,t,a,n,i,r){var o=Me(e),u=Me(t),f=o?Re:Ie(e),d=u?Re:Ie(t);f=f==Le?Y:f,d=d==Le?Y:d;var c=f==Y,b=d==Y,v=f==d;if(v&&Fe(e)){if(!Fe(t))return!1;o=!0,c=!1}if(v&&!c)return r||(r=new ue),o||rn(e)?tn(e,t,a,n,i,r):an(e,t,f,a,n,i,r);if(!(a&nn)){var m=c&&Ve.call(e,"__wrapped__"),l=b&&Ve.call(t,"__wrapped__");if(m||l){var g=m?e.value():e,x=l?t.value():t;return r||(r=new ue),i(g,x,a,n,r)}}return v?(r||(r=new ue),sn(e,t,a,n,i,r)):!1}var un=on,cn=un,ke=se;function et(e,t,a,n,i){return e===t?!0:e==null||t==null||!ke(e)&&!ke(t)?e!==e&&t!==t:cn(e,t,a,n,et,i)}var dn=et,fn=dn;function gn(e,t){return fn(e,t)}var pn=gn;const vn=it(pn);var tt=j.createContext(null),W=()=>{const e=j.useContext(tt);if(!e)throw new Error("useDataTableFacetedFilterContext must be used within a DataTableFacetedFilter");return e},ne=({param:e,prefix:t,multiple:a=!1})=>{const[n,i]=me(),r=t?`${t}_${e}`:e,o=t?`${t}_offset`:"offset";return{add:c=>{i(b=>{const v=new URLSearchParams(b);return a?(()=>{var x;const g=((x=v.get(r))==null?void 0:x.split(","))||[];g.includes(c)||(g.push(c),v.set(r,g.join(",")))})():(()=>{v.set(r,c)})(),v.delete(o),v})},delete:c=>{const b=m=>{var x;const l=((x=m.get(r))==null?void 0:x.split(","))||[],g=l.indexOf(c||"");g>-1&&(l.splice(g,1),m.set(r,l.join(",")))},v=m=>{m.delete(r)};i(m=>(c?(a?b(m):v(m),m.get(r)||m.delete(r)):m.delete(r),m.delete(o),m))},get:()=>{var c;return((c=n.get(r))==null?void 0:c.split(",").filter(Boolean))||[]}}},bn=({hadPreviousValue:e,label:t,value:a,readonly:n,hasOperator:i,onRemove:r})=>{const{t:o}=z(),u=f=>{f.stopPropagation(),r()};return s.jsxs("div",{className:"bg-ui-bg-field transition-fg shadow-borders-base text-ui-fg-subtle flex cursor-default select-none items-stretch overflow-hidden rounded-md",children:[!e&&s.jsx(ut,{}),s.jsx("div",{className:O("flex items-center justify-center whitespace-nowrap px-2 py-1",{"border-r":!!(a||e)}),children:s.jsx(K,{size:"small",weight:"plus",leading:"compact",children:t})}),s.jsxs("div",{className:"flex w-full items-center overflow-hidden",children:[i&&!!(a||e)&&s.jsx("div",{className:"border-r p-1 px-2",children:s.jsx(K,{size:"small",weight:"plus",leading:"compact",className:"text-ui-fg-muted",children:o("general.is")})}),!!(a||e)&&s.jsx(Ue,{asChild:!0,className:O("flex-1 cursor-pointer overflow-hidden border-r p-1 px-2",{"hover:bg-ui-bg-field-hover":!n,"data-[state=open]:bg-ui-bg-field-hover":!n}),children:s.jsx(K,{size:"small",leading:"compact",weight:"plus",className:"truncate text-nowrap",children:a||"Â "})})]}),!n&&!!(a||e)&&s.jsx("button",{onClick:u,className:O("text-ui-fg-muted transition-fg flex items-center justify-center p-1","hover:bg-ui-bg-subtle-hover","active:bg-ui-bg-subtle-pressed active:text-ui-fg-base"),children:s.jsx(ze,{})})]})},ie=bn,mn=({filter:e,prefix:t,readonly:a,openOnMount:n})=>{const[i,r]=j.useState(n),[o,u]=j.useState(!1),{getFullDate:f}=st(),{key:d,label:c}=e,{removeFilter:b}=W(),v=ne({param:d,prefix:t}),m=hn(),l=p=>{v.add(JSON.stringify(p)),u(!1)},g=()=>{v.delete(),u(p=>!p)},x=v.get(),h=xn(x),y=Be(h,"$gte"),w=Be(h,"$lte"),S=(p,N)=>{const F=N==="start"?"$gte":"$lte";let G=p;F==="$lte"&&p&&(G=new Date(p.getTime()),G.setHours(23,59,59,999)),v.add(JSON.stringify({...h||{},[F]:G==null?void 0:G.toISOString()}))},C=()=>{const p=m.find(N=>vn(N.value,h));return p==null?void 0:p.label},M=p=>p?f({date:p}):void 0,E=()=>[y,w].map(M).filter(Boolean).join(" - "),D=C()||E(),[B,T]=j.useState(D),P=()=>{v.delete(),b(d)};let A=null;const _=p=>{r(p),T(D),A&&clearTimeout(A),!p&&!x.length&&(A=setTimeout(()=>{b(d)},200))};return s.jsxs(H,{modal:!0,open:i,onOpenChange:_,children:[s.jsx(ie,{hadPreviousValue:!!B,label:c,value:D,onRemove:P,readonly:a}),!a&&s.jsx(q,{children:s.jsxs(J,{"data-name":"date_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout h-full max-h-[var(--radix-popper-available-height)] w-[300px] overflow-auto rounded-lg"),onInteractOutside:p=>{var N;p.target instanceof HTMLElement&&((N=p.target.attributes.getNamedItem("data-name"))==null?void 0:N.value)==="filters_menu_content"&&p.preventDefault()},children:[s.jsxs("ul",{className:"w-full p-1",children:[m.map(p=>{const N=v.get().includes(JSON.stringify(p.value));return s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:()=>{l(p.value)},children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!N}),children:s.jsx(Z,{})}),p.label]})},p.label)}),s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:g,children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!o}),children:s.jsx(Z,{})}),le("filters.date.custom")]})})]}),o&&s.jsxs("div",{className:"border-t px-1 pb-3 pt-1",children:[s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(K,{size:"xsmall",leading:"compact",weight:"plus",children:le("filters.date.from")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(ye,{modal:!0,maxValue:w,value:y,onChange:p=>S(p,"start")})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(K,{size:"xsmall",leading:"compact",weight:"plus",children:le("filters.date.to")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(ye,{modal:!0,minValue:y,value:w||void 0,onChange:p=>{S(p,"end")}})})]})]})]})})]})},L=new Date;L.setHours(0,0,0,0);var hn=()=>{const{t:e}=z();return j.useMemo(()=>[{label:e("filters.date.today"),value:{$gte:L.toISOString()}},{label:e("filters.date.lastSevenDays"),value:{$gte:new Date(L.getTime()-7*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastThirtyDays"),value:{$gte:new Date(L.getTime()-30*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastNinetyDays"),value:{$gte:new Date(L.getTime()-90*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastTwelveMonths"),value:{$gte:new Date(L.getTime()-365*24*60*60*1e3).toISOString()}}],[e])},xn=e=>e!=null&&e.length?JSON.parse(e.join(",")):null,Be=(e,t)=>{if(!(e!=null&&e[t]))return;const a=new Date(e[t]);return t==="$lte"&&a.setHours(0,0,0,0),a},yn=({filter:e,prefix:t,readonly:a,openOnMount:n})=>{const{t:i}=z(),[r,o]=j.useState(n),{key:u,label:f}=e,{removeFilter:d}=W(),c=ne({param:u,prefix:t,multiple:!1}),b=c.get(),[v,m]=j.useState(b),[l,g]=j.useState(_n(b)),x=j.useCallback(Ke.debounce((T,P)=>{const A=T.target.value,_=JSON.parse((b==null?void 0:b.join(","))||"{}"),p=!isNaN(Number(_)),N=F=>{if(!A&&p){c.delete();return}if(_&&!A){delete _[F],c.add(JSON.stringify(_));return}if(!_){c.add(JSON.stringify({[F]:A}));return}c.add(JSON.stringify({..._,[F]:A}))};switch(P){case"eq":A?c.add(A):c.delete();break;case"lt":case"gt":N(P);break}},500),[c,b]);j.useEffect(()=>()=>{x.cancel()},[x]);let h=null;const y=T=>{o(T),m(b),h&&clearTimeout(h),!T&&!b.length&&(h=setTimeout(()=>{d(u)},200))},w=()=>{c.delete(),d(u)},S=[{operator:"exact",label:i("filters.compare.exact")},{operator:"range",label:i("filters.compare.range")}],C=`${u}-gt`,M=`${u}-lt`,E=u,D=Ge(b,i),B=Ge(v,i);return s.jsxs(H,{modal:!0,open:r,onOpenChange:y,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!B,label:f,value:D,onRemove:w,readonly:a}),!a&&s.jsx(q,{children:s.jsxs(J,{"data-name":"number_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout max-h-[var(--radix-popper-available-height)] w-[300px] divide-y overflow-y-auto rounded-lg outline-none"),onInteractOutside:T=>{var P;T.target instanceof HTMLElement&&((P=T.target.attributes.getNamedItem("data-name"))==null?void 0:P.value)==="filters_menu_content"&&T.preventDefault()},children:[s.jsx("div",{className:"p-1",children:s.jsx(pt,{value:l,onValueChange:T=>g(T),className:"flex flex-col items-start",orientation:"vertical",autoFocus:!0,children:S.map(T=>s.jsxs(vt,{value:T.operator,className:"txt-compact-small hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-hover active:bg-ui-bg-base-pressed transition-fg grid w-full grid-cols-[20px_1fr] gap-2 rounded-[4px] px-2 py-1.5 text-left outline-none",children:[s.jsx("div",{className:"size-5",children:s.jsx(bt,{children:s.jsx(Z,{})})}),s.jsx("span",{className:"w-full",children:T.label})]},T.operator))})}),s.jsx("div",{children:l==="range"?s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:C,children:i("filters.compare.greaterThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:C,size:"small",type:"number",defaultValue:ce(b,"gt"),onChange:T=>x(T,"gt")})}),s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:M,children:i("filters.compare.lessThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:M,size:"small",type:"number",defaultValue:ce(b,"lt"),onChange:T=>x(T,"lt")})})]},"range"):s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:E,children:f})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:E,size:"small",type:"number",defaultValue:ce(b,"eq"),onChange:T=>x(T,"eq")})})]},"exact")})]})})]})},Ge=(e,t)=>{const a=JSON.parse((e==null?void 0:e.join(","))||"{}");let n="";if(typeof a=="object"){const i=[];a.gt&&i.push(t("filters.compare.greaterThanLabel",{value:a.gt})),a.lt&&i.push(t("filters.compare.lessThanLabel",{value:a.lt})),n=i.join(` ${t("filters.compare.andLabel")} `)}return typeof a=="number"&&(n=a.toString()),n},at=e=>{if(!e)return;const t=e.join(",");if(t)return JSON.parse(t)},ce=(e,t)=>{const a=at(e);if(typeof a=="object")return a[t];if(typeof a=="number"&&t==="eq")return a},_n=e=>typeof at(e)=="object"?"range":"exact",jn=({filter:e,prefix:t,readonly:a,multiple:n,searchable:i,options:r,openOnMount:o})=>{const[u,f]=j.useState(o),[d,c]=j.useState(""),[b,v]=j.useState(null),{t:m}=z(),{removeFilter:l}=W(),{key:g,label:x}=e,h=ne({param:g,prefix:t,multiple:n}),y=h.get(),w=y.map(_=>{var p;return(p=r.find(N=>N.value===_))==null?void 0:p.label}).filter(Boolean),[S,C]=j.useState(w),M=()=>{h.delete(),l(g)};let E=null;const D=_=>{f(_),C(w),E&&clearTimeout(E),!_&&!y.length&&(E=setTimeout(()=>{l(g)},200))},B=()=>{c(""),b&&b.focus()},T=_=>{h.get().includes(String(_))?h.delete(String(_)):h.add(String(_))},P=w?Array.isArray(w)?w:[w]:null,A=S?Array.isArray(S)?S:[S]:null;return s.jsxs(H,{modal:!0,open:u,onOpenChange:D,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!(A!=null&&A.length),readonly:a,label:x,value:P==null?void 0:P.join(", "),onRemove:M}),!a&&s.jsx(q,{children:s.jsx(J,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:_=>{var p;_.target instanceof HTMLElement&&((p=_.target.attributes.getNamedItem("data-name"))==null?void 0:p.value)==="filters_menu_content"&&(_.preventDefault(),_.stopPropagation())},children:s.jsxs(U,{className:"h-full",children:[i&&s.jsx("div",{className:"border-b p-1",children:s.jsxs("div",{className:"grid grid-cols-[1fr_20px] gap-x-2 rounded-md px-2 py-1",children:[s.jsx(U.Input,{ref:v,value:d,onValueChange:c,className:"txt-compact-small placeholder:text-ui-fg-muted bg-transparent outline-none",placeholder:"Search"}),s.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:s.jsx("button",{disabled:!d,onClick:B,className:O("transition-fg text-ui-fg-muted focus-visible:bg-ui-bg-base-pressed rounded-md outline-none",{invisible:!d}),children:s.jsx(ze,{})})})]})}),s.jsx(U.Empty,{className:"txt-compact-small flex items-center justify-center p-1",children:s.jsx("span",{className:"w-full px-2 py-1 text-center",children:m("general.noResultsTitle")})}),s.jsx(U.List,{className:"h-full max-h-[163px] min-h-[0] overflow-auto p-1 outline-none",children:r.map(_=>{const p=h.get().includes(String(_.value));return s.jsxs(U.Item,{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover aria-selected:bg-ui-bg-base-pressed focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center gap-x-2 rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",value:_.label,onSelect:()=>{T(_.value)},children:[s.jsx("div",{className:O("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!p}),children:n?s.jsx(ot,{}):s.jsx(Z,{})}),_.label]},String(_.value))})})]})})})]})},$n=({filter:e,prefix:t,readonly:a,openOnMount:n})=>{const[i,r]=j.useState(n),{key:o,label:u}=e,{removeFilter:f}=W(),d=ne({param:o,prefix:t}),c=d.get(),[b,v]=j.useState(c==null?void 0:c[0]),m=j.useCallback(Ke.debounce(h=>{const y=h.target.value;y?d.add(y):d.delete()},500),[d]);j.useEffect(()=>()=>{m.cancel()},[m]);let l=null;const g=h=>{r(h),v(c==null?void 0:c[0]),l&&clearTimeout(l),!h&&!c.length&&(l=setTimeout(()=>{f(o)},200))},x=()=>{d.delete(),f(o)};return s.jsxs(H,{modal:!0,open:i,onOpenChange:g,children:[s.jsx(ie,{hasOperator:!0,hadPreviousValue:!!b,label:u,value:c==null?void 0:c[0],onRemove:x,readonly:a}),!a&&s.jsx(q,{children:s.jsx(J,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:h=>{var y;h.target instanceof HTMLElement&&((y=h.target.attributes.getNamedItem("data-name"))==null?void 0:y.value)==="filters_menu_content"&&(h.preventDefault(),h.stopPropagation())},children:s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(X,{size:"xsmall",weight:"plus",htmlFor:o,children:u})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Q,{name:o,size:"small",defaultValue:(c==null?void 0:c[0])||void 0,onChange:m})})]})})})]})},Cn=({filters:e,readonly:t,prefix:a})=>{const{t:n}=z(),[i]=me(),[r,o]=j.useState(!1),[u,f]=j.useState(wn({searchParams:i,filters:e,prefix:a})),d=e.filter(l=>!u.find(g=>g.key===l.key)),c=j.useRef(!0);j.useEffect(()=>{if(c.current){const l=new URLSearchParams(i);e.forEach(g=>{const x=a?`${a}_${g.key}`:g.key;l.get(x)&&!u.find(y=>y.key===g.key)&&(g.type==="select"?f(y=>[...y,{...g,multiple:g.multiple,options:g.options,openOnMount:!1}]):f(y=>[...y,{...g,openOnMount:!1}]))})}c.current=!1},[u,e,a,i]);const b=l=>{o(!1),f(g=>[...g,{...l,openOnMount:!0}])},v=j.useCallback(l=>{f(g=>g.filter(x=>x.key!==l))},[]),m=j.useCallback(()=>{f([])},[]);return s.jsx(tt.Provider,{value:j.useMemo(()=>({removeFilter:v,removeAllFilters:m}),[m,v]),children:s.jsxs("div",{className:"max-w-2/3 flex flex-wrap items-center gap-2",children:[u.map(l=>{switch(l.type){case"select":return s.jsx(jn,{filter:l,prefix:a,readonly:t,options:l.options,multiple:l.multiple,searchable:l.searchable,openOnMount:l.openOnMount},l.key);case"date":return s.jsx(mn,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key);case"string":return s.jsx($n,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key);case"number":return s.jsx(yn,{filter:l,prefix:a,readonly:t,openOnMount:l.openOnMount},l.key)}}),!t&&d.length>0&&s.jsxs(H,{modal:!0,open:r,onOpenChange:o,children:[s.jsx(Ue,{asChild:!0,id:"filters_menu_trigger",children:s.jsx(lt,{size:"small",variant:"secondary",children:n("filters.addFilter")})}),s.jsx(q,{children:s.jsx(J,{className:O("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-auto rounded-lg p-1 outline-none"),"data-name":"filters_menu_content",align:"start",sideOffset:8,collisionPadding:8,onCloseAutoFocus:l=>{u.find(x=>x.openOnMount)&&l.preventDefault()},children:d.map(l=>s.jsx("div",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",role:"menuitem",onClick:()=>{b(l)},children:l.label},l.key))})})]}),!t&&u.length>0&&s.jsx(Tn,{filters:e,prefix:a})]})})},Tn=({filters:e,prefix:t})=>{const{removeAllFilters:a}=W(),[n,i]=me(),r=()=>{i(o=>{const u=new URLSearchParams(o);return e.forEach(f=>{u.delete(t?`${t}_${f.key}`:f.key)}),u}),a()};return s.jsx("button",{type:"button",onClick:r,className:O("text-ui-fg-muted transition-fg txt-compact-small-plus rounded-md px-2 py-1","hover:text-ui-fg-subtle","focus-visible:shadow-borders-focus"),children:"Clear all"})},wn=({searchParams:e,filters:t,prefix:a})=>{const n=new URLSearchParams(e),i=[];return t.forEach(r=>{const o=a?`${a}_${r.key}`:r.key;n.get(o)&&(r.type==="select"?i.push({...r,multiple:r.multiple,options:r.options,openOnMount:!1}):i.push({...r,openOnMount:!1}))}),i};export{Cn as D,ne as u};
