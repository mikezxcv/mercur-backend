import{D as W}from"./chunk-HQKGZADC-DuUbCtSs.js";import{N as Y,a as X}from"./chunk-EMIHDNB7-DCWfH-IR.js";import{D as Z,u as G}from"./chunk-5JIBQRMV-DzupbFxh.js";import{r as x,j as e,b as V,bG as _,Y as ee,bH as te,I as p,ao as se,bI as ae,bJ as ne,bK as le,bL as oe,bM as P,bN as J,L as re,ah as D}from"./index-Bxfpjf1r.js";var ie=({placeholder:s,prefix:a,autofocus:i})=>{const{t:r}=V(),l=s||r("general.search"),d=G({param:"q",prefix:a,multiple:!1}),m=d.get(),o=x.useCallback(_.debounce(c=>{const C=c.target.value;C?d.add(C):d.delete()},500),[d]);return x.useEffect(()=>()=>{o.cancel()},[o]),e.jsx(ee,{autoComplete:"off",name:"q",type:"search",size:"small",autoFocus:i,defaultValue:(m==null?void 0:m[0])||void 0,onChange:o,placeholder:l})},ce=({search:s,orderBy:a,filters:i,prefix:r})=>(s||a||i||r)&&e.jsxs("div",{className:"flex items-start justify-between gap-x-4 px-6 py-4",children:[e.jsx("div",{className:"w-full max-w-[60%]",children:i&&i.length>0&&e.jsx(Z,{filters:i,prefix:r})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-x-2",children:[s&&e.jsx(ie,{prefix:r,autofocus:s==="autofocus"}),a&&e.jsx(W,{keys:a,prefix:r})]})]}),de=({table:s,columns:a,pagination:i,navigateTo:r,commands:l,count:d=0,noResults:m=!1,noHeader:o=!1,layout:c="fit"})=>{const{t:C}=V(),[y,k]=x.useState(!1),S=x.useRef(null),v=a.find(t=>t.id==="select"),u=a.find(t=>t.id==="actions"),j=l&&l.length>0,g=s.getState().rowSelection,{pageIndex:R,pageSize:T}=s.getState().pagination,E=100/(a.length-(v?1:0)-(u?1:0)),O=t=>{t.currentTarget.scrollLeft>0?k(!0):k(!1)},F=async t=>{await t(g).then(()=>{s.resetRowSelection()})};return x.useEffect(()=>{var t;(t=S.current)==null||t.scroll({top:0,left:0})},[R]),e.jsxs("div",{className:p("flex w-full flex-col overflow-hidden",{"flex flex-1 flex-col":c==="fill"}),children:[e.jsx("div",{ref:S,onScroll:O,className:p("w-full",{"min-h-0 flex-grow overflow-auto":c==="fill","overflow-x-auto":c==="fit"}),children:m?e.jsx("div",{className:p({"border-b":c==="fit"}),children:e.jsx(X,{})}):e.jsxs(P,{className:"relative w-full",children:[!o&&e.jsx(P.Header,{className:"border-t-0",children:s.getHeaderGroups().map(t=>e.jsx(P.Row,{className:p({"relative border-b-0 [&_th:last-of-type]:w-[1%] [&_th:last-of-type]:whitespace-nowrap":u,"[&_th:first-of-type]:w-[1%] [&_th:first-of-type]:whitespace-nowrap":v}),children:t.headers.map((n,H)=>{const w=n.id==="actions",f=n.id==="select",h=w||f,I=t.headers.findIndex(L=>L.id!=="select"),N=I!==-1?n.id===t.headers[I].id:H===0,b=f||N;return e.jsx(P.HeaderCell,{"data-table-header-id":n.id,style:{width:h?void 0:`${E}%`},className:p({"bg-ui-bg-subtle sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":b,"left-[68px]":b&&v&&!f,"after:bg-ui-border-base":y&&b&&!h}),children:J(n.column.columnDef.header,n.getContext())},n.id)})},t.id))}),e.jsx(P.Body,{className:"border-b-0",children:s.getRowModel().rows.map(t=>{const n=r?r(t):void 0,H=v&&!t.getCanSelect(),w=t.depth%2!==0,f=t.getVisibleCells();return e.jsx(P.Row,{"data-selected":t.getIsSelected(),className:p("transition-fg group/row group relative [&_td:last-of-type]:w-[1%] [&_td:last-of-type]:whitespace-nowrap","has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover",{"bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover":w,"cursor-pointer":!!n,"bg-ui-bg-highlight hover:bg-ui-bg-highlight-hover":t.getIsSelected(),"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),children:f.map((h,I)=>{const N=t.getVisibleCells(),b=h.column.id==="select",L=N.findIndex(U=>U.column.id!=="select"),A=L!==-1?h.column.id===N[L].column.id:I===0,z=b||A,$=t.depth>0&&A?t.depth*14+24:void 0,Q=z&&v&&!b,B=J(h.column.columnDef.cell,h.getContext()),K=A&&!!n,q=!!n&&!b;return e.jsx(P.Cell,{className:p({"!ps-0 !pe-0":q,"bg-ui-bg-base group-data-[selected=true]/row:bg-ui-bg-highlight group-data-[selected=true]/row:group-hover/row:bg-ui-bg-highlight-hover group-hover/row:bg-ui-bg-base-hover transition-fg group-has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":z,"bg-ui-bg-subtle group-hover/row:bg-ui-bg-subtle-hover":w&&z,"left-[68px]":Q,"after:bg-ui-border-base":y&&z&&!b,"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),style:{paddingLeft:$?`${$}px`:void 0},children:q?e.jsx(re,{to:n,className:"size-full outline-none","data-row-link":!0,tabIndex:K?0:-1,children:e.jsx("div",{className:p("flex size-full items-center pe-6",{"ps-6":K&&!Q}),children:B})}):B},h.id)})},t.id)})})]})}),i&&e.jsx("div",{className:p({"border-t":c==="fill"}),children:e.jsx(ue,{canNextPage:s.getCanNextPage(),canPreviousPage:s.getCanPreviousPage(),nextPage:s.nextPage,previousPage:s.previousPage,count:d,pageIndex:R,pageCount:s.getPageCount(),pageSize:T})}),j&&e.jsx(D,{open:!!Object.keys(g).length,children:e.jsxs(D.Bar,{children:[e.jsx(D.Value,{children:C("general.countSelected",{count:Object.keys(g).length})}),e.jsx(D.Seperator,{}),l==null?void 0:l.map((t,n)=>e.jsxs(x.Fragment,{children:[e.jsx(D.Command,{label:t.label,shortcut:t.shortcut,action:()=>F(t.action)}),n<l.length-1&&e.jsx(D.Seperator,{})]},n))]})})]})},ue=s=>{const{t:a}=V(),i={of:a("general.of"),results:a("general.results"),pages:a("general.pages"),prev:a("general.prev"),next:a("general.next")};return e.jsx(P.Pagination,{className:"flex-shrink-0",...s,translations:i})},ge=x.memo(ce),xe=({table:s,columns:a,pagination:i,navigateTo:r,commands:l,count:d=0,search:m=!1,orderBy:o,filters:c,prefix:C,queryObject:y={},pageSize:k,isLoading:S=!1,noHeader:v=!1,layout:u="fit",noRecords:j={}})=>{if(S)return e.jsx(te,{layout:u,rowCount:k,search:!!m,filters:!!(c!=null&&c.length),orderBy:!!(o!=null&&o.length),pagination:!!i});const g=Object.values(y).filter(M=>!!M).length===0,R=!S&&d===0&&!g;return!S&&d===0&&g?e.jsx(Y,{className:p({"flex h-full flex-col overflow-hidden":u==="fill"}),...j}):e.jsxs("div",{className:p("divide-y",{"flex h-full flex-col overflow-hidden":u==="fill"}),children:[e.jsx(ge,{search:m,orderBy:o,filters:c,prefix:C}),e.jsx(de,{table:s,count:d,columns:a,pagination:!0,navigateTo:r,commands:l,noResults:R,noHeader:v,layout:u})]})},me=({data:s=[],columns:a,count:i=0,pageSize:r=20,enablePagination:l=!0,enableRowSelection:d=!1,enableExpandableRows:m=!1,rowSelection:o,getSubRows:c,getRowId:C,meta:y,prefix:k})=>{const[S,v]=se(),u=`${k?`${k}_`:""}offset`,j=S.get(u),[{pageIndex:g,pageSize:R},T]=x.useState({pageIndex:j?Math.ceil(Number(j)/r):0,pageSize:r}),M=x.useMemo(()=>({pageIndex:g,pageSize:R}),[g,R]),[E,O]=x.useState({}),F=(o==null?void 0:o.state)??E,t=(o==null?void 0:o.updater)??O;x.useEffect(()=>{if(!l)return;const w=j?Math.ceil(Number(j)/r):0;w!==g&&T(f=>({...f,pageIndex:w}))},[j,l,r,g]);const n=w=>{const f=w(M),{pageIndex:h,pageSize:I}=f;return v(N=>{if(!h)return N.delete(u),N;const b=new URLSearchParams(N);return b.set(u,String(h*I)),b}),T(f),f};return{table:ae({data:s,columns:a,state:{rowSelection:F,pagination:l?M:void 0},pageCount:Math.ceil((i??0)/R),enableRowSelection:d,getRowId:C,getSubRows:c,onRowSelectionChange:d?t:void 0,onPaginationChange:l?n:void 0,getCoreRowModel:ne(),getPaginationRowModel:l?le():void 0,getExpandedRowModel:m?oe():void 0,manualPagination:l?!0:void 0,meta:y})}};export{ie as D,xe as _,me as u};
