import{r as f,cH as I,cI as v,cJ as S,k as B}from"./index-Bxfpjf1r.js";var C=()=>{const[n,s]=f.useState(""),[i,t]=f.useState(""),o=f.useCallback(I(r=>t(r),300),[]);return f.useEffect(()=>(o(n),()=>o.cancel()),[n,o]),{searchValue:n,onSearchValueChange:s,query:i||void 0}},k=({queryKey:n,queryFn:s,getOptions:i,defaultValue:t,defaultValueKey:o,selectedValue:r,pageSize:x=10,enabled:c=!0})=>{const{searchValue:h,onSearchValueChange:q,query:d}=C(),E=o||"id",{data:l}=v({queryKey:[...n,t].filter(Boolean),queryFn:async()=>s({[E]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&c}),{data:m}=v({queryKey:[...n,r].filter(Boolean),queryFn:async()=>s({id:r,limit:1}),enabled:!!r&&c}),{data:y,...b}=S({queryKey:[...n,"_cbx_",d].filter(Boolean),queryFn:async({pageParam:e=0})=>await s({q:d,limit:x,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:B,enabled:c}),a=(y==null?void 0:y.pages.flatMap(e=>i(e)))??[],D=l?i(l):[],p=m?i(m):[],g=!b.isPending&&!a.length&&!h||!c;return t&&D.length&&!h&&D.forEach(e=>{a.find(u=>u.value===e.value)||a.unshift(e)}),r&&p.length&&p.forEach(e=>{a.find(u=>u.value===e.value)||a.unshift(e)}),{options:a,searchValue:h,onSearchValueChange:q,disabled:g,...b}};export{C as a,k as u};
