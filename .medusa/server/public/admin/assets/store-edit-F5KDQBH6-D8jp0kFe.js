import{u as g}from"./chunk-HFB3OQXI-PWnyeNsG.js";import{C as b}from"./chunk-OFN7DIZA-DpTF6pNJ.js";import{K as q}from"./chunk-6HTZNHPT-BHsf02UK.js";import{b as d,u as K}from"./chunk-AERWK3TJ-2NOSGJWi.js";import{ar as w,at as t,b as L,v as k,j as e,H as z,K as D,ay as M,az as N,fe as R,s as y,t as v,X as a,Y as T,av as c,B as F}from"./index-Bxfpjf1r.js";var B=w({name:t().min(1),default_currency_code:t().optional(),default_region_id:t().optional(),default_sales_channel_id:t().optional(),default_location_id:t().optional()}),H=({store:s})=>{var C,S;const{t:l}=L(),{handleSuccess:x}=K(),j=D(),r=M({defaultValues:{name:s.name,default_region_id:s.default_region_id||void 0,default_currency_code:((S=(C=s.supported_currencies)==null?void 0:C.find(n=>n.is_default))==null?void 0:S.currency_code)||void 0,default_sales_channel_id:s.default_sales_channel_id||void 0,default_location_id:s.default_location_id||void 0},resolver:N(B)}),{mutateAsync:p,isPending:E}=R(s.id),u=g({queryKey:["regions","default_region_id"],queryFn:n=>y.admin.region.list({...n,fields:"id,name"}),defaultValue:s.default_region_id||void 0,getOptions:n=>n.regions.map(o=>({label:o.name,value:o.id}))}),h=g({queryFn:n=>y.admin.salesChannel.list({...n,fields:"id,name"}),getOptions:n=>n.sales_channels.map(o=>({label:o.name,value:o.id})),queryKey:["sales_channels","default_sales_channel_id"],defaultValue:s.default_sales_channel_id||void 0}),m=g({queryFn:n=>y.admin.stockLocation.list({...n,fields:"id,name"}),getOptions:n=>n.stock_locations.map(o=>({label:o.name,value:o.id})),queryKey:["stock_locations","default_location_id"],defaultValue:s.default_location_id||void 0}),I=r.handleSubmit(async n=>{var V;const{default_currency_code:o,..._}=n,i={..._,supported_currencies:(V=s.supported_currencies)==null?void 0:V.map(f=>({...f,is_default:f.currency_code===o}))};await p(i,{onSuccess:()=>{v.success(l("store.toast.update")),x()},onError:f=>{v.error(f.message)}})});return e.jsx(d.Form,{form:r,children:e.jsxs(q,{onSubmit:I,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(d.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(a.Field,{control:r.control,name:"name",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:l("fields.name")}),e.jsx(a.Control,{children:e.jsx(T,{placeholder:"ACME",...n})}),e.jsx(a.ErrorMessage,{})]})}),e.jsx(a.Field,{control:r.control,name:"default_currency_code",render:({field:{onChange:n,...o}})=>{var _;return e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:l("store.defaultCurrency")}),e.jsx(a.Control,{children:e.jsxs(c,{dir:j,...o,onValueChange:n,children:[e.jsx(c.Trigger,{ref:o.ref,children:e.jsx(c.Value,{})}),e.jsx(c.Content,{children:(_=s.supported_currencies)==null?void 0:_.map(i=>e.jsx(c.Item,{value:i.currency_code,children:i.currency_code.toUpperCase()},i.currency_code))})]})})]})}}),e.jsx(a.Field,{control:r.control,name:"default_region_id",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:l("store.defaultRegion")}),e.jsx(a.Control,{children:e.jsx(b,{...n,options:u.options,searchValue:u.searchValue,onSearchValueChange:u.onSearchValueChange,disabled:u.disabled})})]})}),e.jsx(a.Field,{control:r.control,name:"default_sales_channel_id",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:l("store.defaultSalesChannel")}),e.jsx(a.Control,{children:e.jsx(b,{...n,options:h.options,searchValue:h.searchValue,onSearchValueChange:h.onSearchValueChange,disabled:h.disabled})})]})}),e.jsx(a.Field,{control:r.control,name:"default_location_id",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:l("store.defaultLocation")}),e.jsx(a.Control,{children:e.jsx(b,{...n,options:m.options,searchValue:m.searchValue,onSearchValueChange:m.onSearchValueChange,disabled:m.disabled})})]})})]})}),e.jsx(d.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(d.Close,{asChild:!0,children:e.jsx(F,{size:"small",variant:"secondary",children:l("actions.cancel")})}),e.jsx(F,{size:"small",isLoading:E,type:"submit",children:l("actions.save")})]})})]})})},Y=()=>{const{t:s}=L(),{store:l,isPending:x,isError:j,error:r}=k();if(j)throw r;const p=!!l&&!x;return e.jsxs(d,{children:[e.jsx(d.Header,{children:e.jsx(z,{children:s("store.edit.header")})}),p&&e.jsx(H,{store:l})]})};export{Y as Component};
