import{f as F}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{u as L}from"./chunk-HFB3OQXI-PWnyeNsG.js";import{C as R}from"./chunk-OFN7DIZA-DpTF6pNJ.js";import{c as I}from"./chunk-DK4WIVY6-CYCbBMOO.js";import{K as S}from"./chunk-6HTZNHPT-BHsf02UK.js";import{b as l,u as H}from"./chunk-AERWK3TJ-2NOSGJWi.js";import{ar as T,at as _,aD as M,au as b,b as w,ac as k,f9 as D,v as z,y as B,j as e,H as K,K as U,ay as V,fb as q,t as C,X as s,Y as A,av as u,aB as E,_ as P,B as N,s as O}from"./index-Bxfpjf1r.js";T({name:_().min(1),currency_code:_(),payment_providers:M(_()),automatic_taxes:b(),is_tax_inclusive:b()});var X=({region:o,currencies:j,pricePreferences:t})=>{var p;const{t:i}=w(),{handleSuccess:f}=H(),d=t==null?void 0:t.find(r=>r.attribute==="region_id"&&r.value===o.id),x=U(),a=V({defaultValues:{name:o.name,currency_code:o.currency_code.toUpperCase(),payment_providers:((p=o.payment_providers)==null?void 0:p.map(r=>r.id))||[],automatic_taxes:o.automatic_taxes,is_tax_inclusive:(d==null?void 0:d.is_tax_inclusive)||!1}}),h=L({queryKey:["payment_providers"],queryFn:r=>O.admin.payment.listPaymentProviders({...r,is_enabled:!0}),getOptions:r=>r.payment_providers.map(n=>({label:F(n.id),value:n.id}))}),{mutateAsync:g,isPending:y}=q(o.id),v=a.handleSubmit(async r=>{await g({name:r.name,automatic_taxes:r.automatic_taxes,currency_code:r.currency_code.toLowerCase(),payment_providers:r.payment_providers,is_tax_inclusive:r.is_tax_inclusive},{onSuccess:()=>{C.success(i("regions.toast.edit")),f()},onError:n=>{C.error(n.message)}})});return e.jsx(l.Form,{form:a,children:e.jsxs(S,{onSubmit:v,className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(l.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:a.control,name:"name",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.name")}),e.jsx(s.Control,{children:e.jsx(A,{...r})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:a.control,name:"currency_code",render:({field:{onChange:r,ref:n,...c}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.currency")}),e.jsx(s.Control,{children:e.jsxs(u,{dir:x,onValueChange:r,...c,children:[e.jsx(u.Trigger,{ref:n,children:e.jsx(u.Value,{})}),e.jsx(u.Content,{children:j.map(m=>e.jsx(u.Item,{value:m.code,children:m.code.toUpperCase()},m.code))})]})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:a.control,name:"automatic_taxes",render:({field:{value:r,onChange:n,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.automaticTaxes")}),e.jsx(s.Control,{children:e.jsx(E,{dir:"ltr",className:"rtl:rotate-180",...c,checked:r,onCheckedChange:n})})]}),e.jsx(s.Hint,{children:i("regions.automaticTaxesHint")}),e.jsx(s.ErrorMessage,{})]})})}),e.jsx(s.Field,{control:a.control,name:"is_tax_inclusive",render:({field:{value:r,onChange:n,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.taxInclusivePricing")}),e.jsx(s.Control,{children:e.jsx(E,{dir:"ltr",className:"rtl:rotate-180",...c,checked:r,onCheckedChange:n})})]}),e.jsx(s.Hint,{children:i("regions.taxInclusiveHint")}),e.jsx(s.ErrorMessage,{})]})})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{children:[e.jsx(P,{size:"small",leading:"compact",weight:"plus",children:"Providers"}),e.jsx(P,{size:"small",className:"text-ui-fg-subtle",children:i("regions.providersHint")})]}),e.jsx(s.Field,{control:a.control,name:"payment_providers",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.paymentProviders")}),e.jsx(s.Control,{children:e.jsx(R,{forceHideInput:!0,options:h.options,fetchNextPage:h.fetchNextPage,...r})}),e.jsx(s.ErrorMessage,{})]})})]})]})}),e.jsx(l.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(N,{size:"small",variant:"secondary",children:i("actions.cancel")})}),e.jsx(N,{size:"small",type:"submit",isLoading:y,children:i("actions.save")})]})})]})})},ee=()=>{const{t:o}=w(),{id:j}=k(),{region:t,isPending:i,isError:f,error:d}=D(j,{fields:"*payment_providers,*countries,+automatic_taxes"}),{store:x,isPending:a,isError:h,error:g}=z(),{price_preferences:y=[],isPending:v,isError:p,error:r}=B({attribute:"region_id",value:j},{enabled:!!t}),n=i||a||v,c=((x==null?void 0:x.supported_currencies)??[]).map(m=>I[m.currency_code.toUpperCase()]);if(f)throw d;if(h)throw g;if(p)throw r;return e.jsxs(l,{children:[e.jsx(l.Header,{children:e.jsx(K,{children:o("regions.editRegion")})}),!n&&t&&e.jsx(X,{region:t,currencies:c,pricePreferences:y})]})};export{ee as Component};
